(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{446:function(t,_,v){"use strict";v.r(_);var e=v(25),i=Object(e.a)({},(function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"评论表设计"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#评论表设计"}},[t._v("#")]),t._v(" 评论表设计")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("什么是二级评论")]),t._v(" "),v("ul",[v("li",[t._v("只有对话题的评论占楼（2、3 ... 楼），评论挂在话题下面")]),t._v(" "),v("li",[t._v("其余的为对评论（各楼层）的回复，或对回复的回复，这些统一按时间排序，挂在对话题的评论下面")])])]),t._v(" "),v("li",[v("p",[t._v("评论表（tbl_comment）设计如下：")])])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("表字段")]),t._v(" "),v("th",{staticStyle:{"text-align":"right"}},[t._v("字段说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("id")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("主键")])]),t._v(" "),v("tr",[v("td",[t._v("topic_id")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("话题 id")])]),t._v(" "),v("tr",[v("td",[t._v("topic_type")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("话题类型")])]),t._v(" "),v("tr",[v("td",[t._v("content")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("评论内容")])]),t._v(" "),v("tr",[v("td",[t._v("from_uid")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("评论用户 id")])])])]),t._v(" "),v("ul",[v("li",[t._v("回复表（tbl_reply）设计如下：")])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("表字段")]),t._v(" "),v("th",{staticStyle:{"text-align":"right"}},[t._v("字段说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("id")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("主键")])]),t._v(" "),v("tr",[v("td",[t._v("comment_id")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("评论 id")])]),t._v(" "),v("tr",[v("td",[t._v("reply_id")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("回复目标 id")])]),t._v(" "),v("tr",[v("td",[t._v("reply_type")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("回复类型")])]),t._v(" "),v("tr",[v("td",[t._v("content")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("回复内容")])]),t._v(" "),v("tr",[v("td",[t._v("from_uid")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("回复用户 id")])]),t._v(" "),v("tr",[v("td",[t._v("to_uid")]),t._v(" "),v("td",{staticStyle:{"text-align":"right"}},[t._v("目标用户 id")])])])]),t._v(" "),v("ul",[v("li",[v("p",[t._v("回复表添加了一个 "),v("code",[t._v("comment_id")]),t._v(" 字段来表示该回复挂在的根评论 "),v("code",[t._v("id")]),t._v("，这样设计也是出于性能方面的考虑，我们可以直接通过评论 "),v("code",[t._v("id")]),t._v(" 一次性的找出该评论下的所有回复，然后通过程序来编排回复的显示结构。 "),v("strong",[t._v("通过适当的冗余来提高性能也是常用的优化手段之一")]),t._v("。")])]),t._v(" "),v("li",[v("p",[v("code",[t._v("reply_type")]),t._v("：表示回复的类型，因为回复可以是针对评论的回复（"),v("code",[t._v("comment")]),t._v("），也可以是针对回复的回复（"),v("code",[t._v("reply")]),t._v("）， 通过这个字段来区分两种情景。")])]),t._v(" "),v("li",[v("p",[v("code",[t._v("reply_id")]),t._v("：表示回复目标的 "),v("code",[t._v("id")]),t._v("，如果 "),v("code",[t._v("reply_type")]),t._v(" 是 "),v("code",[t._v("comment")]),t._v(" 的话，那么 "),v("code",[t._v("reply_id")]),t._v(" ＝ "),v("code",[t._v("commit_id")]),t._v("，如果 "),v("code",[t._v("reply_type")]),t._v(" 是 "),v("code",[t._v("reply")]),t._v(" 的话，这表示这条回复的父回复。")])]),t._v(" "),v("li",[v("p",[t._v("由于二级评论一般是 “A @ B” 的形式，所以存下 "),v("code",[t._v("from_uid")]),t._v(" 和 "),v("code",[t._v("to_uid")]),t._v(" 可以省去关联查询。")])])])])}),[],!1,null,null,null);_.default=i.exports}}]);