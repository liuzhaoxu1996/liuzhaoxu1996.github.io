<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>face-api.js | Zhaoxu Liu</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Zhaoxu Liu">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.b5f0b03a.css" as="style"><link rel="preload" href="/assets/js/app.07bc8ac9.js" as="script"><link rel="preload" href="/assets/js/2.54df97aa.js" as="script"><link rel="preload" href="/assets/js/95.bba70dd1.js" as="script"><link rel="prefetch" href="/assets/js/10.f289ec56.js"><link rel="prefetch" href="/assets/js/100.9d553a15.js"><link rel="prefetch" href="/assets/js/101.30d35580.js"><link rel="prefetch" href="/assets/js/102.b5ba3877.js"><link rel="prefetch" href="/assets/js/103.5f080aeb.js"><link rel="prefetch" href="/assets/js/104.ab7af729.js"><link rel="prefetch" href="/assets/js/105.93deeee5.js"><link rel="prefetch" href="/assets/js/106.bc89b6d0.js"><link rel="prefetch" href="/assets/js/107.dac720bd.js"><link rel="prefetch" href="/assets/js/108.1f3bb1dd.js"><link rel="prefetch" href="/assets/js/109.4ceac602.js"><link rel="prefetch" href="/assets/js/11.e64c384a.js"><link rel="prefetch" href="/assets/js/110.4605645b.js"><link rel="prefetch" href="/assets/js/111.cc1ef84e.js"><link rel="prefetch" href="/assets/js/12.5d143ad4.js"><link rel="prefetch" href="/assets/js/13.6227cbaa.js"><link rel="prefetch" href="/assets/js/14.d52677da.js"><link rel="prefetch" href="/assets/js/15.4fa77a68.js"><link rel="prefetch" href="/assets/js/16.57c8322b.js"><link rel="prefetch" href="/assets/js/17.4b245436.js"><link rel="prefetch" href="/assets/js/18.1b195508.js"><link rel="prefetch" href="/assets/js/19.db2151d7.js"><link rel="prefetch" href="/assets/js/20.f3f9df2a.js"><link rel="prefetch" href="/assets/js/21.51f62eb2.js"><link rel="prefetch" href="/assets/js/22.977925cc.js"><link rel="prefetch" href="/assets/js/23.8efab876.js"><link rel="prefetch" href="/assets/js/24.4ee586eb.js"><link rel="prefetch" href="/assets/js/25.11ba3208.js"><link rel="prefetch" href="/assets/js/26.1de172c6.js"><link rel="prefetch" href="/assets/js/27.f0311b69.js"><link rel="prefetch" href="/assets/js/28.fae550dc.js"><link rel="prefetch" href="/assets/js/29.7b8b91e6.js"><link rel="prefetch" href="/assets/js/3.1a64a66a.js"><link rel="prefetch" href="/assets/js/30.0e1868ab.js"><link rel="prefetch" href="/assets/js/31.06222bc4.js"><link rel="prefetch" href="/assets/js/32.47450fe1.js"><link rel="prefetch" href="/assets/js/33.bacbefde.js"><link rel="prefetch" href="/assets/js/34.27dd37c1.js"><link rel="prefetch" href="/assets/js/35.0b361b38.js"><link rel="prefetch" href="/assets/js/36.691f2c9d.js"><link rel="prefetch" href="/assets/js/37.19d2da36.js"><link rel="prefetch" href="/assets/js/38.8ec9b94d.js"><link rel="prefetch" href="/assets/js/39.fabfcff6.js"><link rel="prefetch" href="/assets/js/4.18b7f171.js"><link rel="prefetch" href="/assets/js/40.3dc66611.js"><link rel="prefetch" href="/assets/js/41.889ab4e5.js"><link rel="prefetch" href="/assets/js/42.33865746.js"><link rel="prefetch" href="/assets/js/43.2073ebe1.js"><link rel="prefetch" href="/assets/js/44.0fbfc8ea.js"><link rel="prefetch" href="/assets/js/45.c5795cee.js"><link rel="prefetch" href="/assets/js/46.3ab420b3.js"><link rel="prefetch" href="/assets/js/47.b447b4a8.js"><link rel="prefetch" href="/assets/js/48.f7c3f597.js"><link rel="prefetch" href="/assets/js/49.9d165572.js"><link rel="prefetch" href="/assets/js/5.718994b1.js"><link rel="prefetch" href="/assets/js/50.3cc9de09.js"><link rel="prefetch" href="/assets/js/51.472663c3.js"><link rel="prefetch" href="/assets/js/52.11796b68.js"><link rel="prefetch" href="/assets/js/53.b1e7bf26.js"><link rel="prefetch" href="/assets/js/54.0fcce785.js"><link rel="prefetch" href="/assets/js/55.1d1cc58b.js"><link rel="prefetch" href="/assets/js/56.413107d6.js"><link rel="prefetch" href="/assets/js/57.705d29b5.js"><link rel="prefetch" href="/assets/js/58.69b8f4be.js"><link rel="prefetch" href="/assets/js/59.dc4ad713.js"><link rel="prefetch" href="/assets/js/6.eafd2c6f.js"><link rel="prefetch" href="/assets/js/60.03da4f70.js"><link rel="prefetch" href="/assets/js/61.dcae5138.js"><link rel="prefetch" href="/assets/js/62.b5787962.js"><link rel="prefetch" href="/assets/js/63.ac5e7a71.js"><link rel="prefetch" href="/assets/js/64.ccc02967.js"><link rel="prefetch" href="/assets/js/65.543c9ff7.js"><link rel="prefetch" href="/assets/js/66.4b8131a8.js"><link rel="prefetch" href="/assets/js/67.0e690903.js"><link rel="prefetch" href="/assets/js/68.2aff0cff.js"><link rel="prefetch" href="/assets/js/69.192eeeee.js"><link rel="prefetch" href="/assets/js/7.368c0350.js"><link rel="prefetch" href="/assets/js/70.b52584ac.js"><link rel="prefetch" href="/assets/js/71.36a19599.js"><link rel="prefetch" href="/assets/js/72.9f13ca31.js"><link rel="prefetch" href="/assets/js/73.27c81fb7.js"><link rel="prefetch" href="/assets/js/74.fd0408a1.js"><link rel="prefetch" href="/assets/js/75.7a09263f.js"><link rel="prefetch" href="/assets/js/76.232b5252.js"><link rel="prefetch" href="/assets/js/77.4493ea6f.js"><link rel="prefetch" href="/assets/js/78.48d5a87c.js"><link rel="prefetch" href="/assets/js/79.8a784179.js"><link rel="prefetch" href="/assets/js/8.d250195f.js"><link rel="prefetch" href="/assets/js/80.d1a94db6.js"><link rel="prefetch" href="/assets/js/81.46d2cc59.js"><link rel="prefetch" href="/assets/js/82.8d2109b0.js"><link rel="prefetch" href="/assets/js/83.fa79cd42.js"><link rel="prefetch" href="/assets/js/84.32bbde64.js"><link rel="prefetch" href="/assets/js/85.87e66000.js"><link rel="prefetch" href="/assets/js/86.c57b4846.js"><link rel="prefetch" href="/assets/js/87.2e92d4cf.js"><link rel="prefetch" href="/assets/js/88.0e951151.js"><link rel="prefetch" href="/assets/js/89.b9d398e6.js"><link rel="prefetch" href="/assets/js/9.ddd09617.js"><link rel="prefetch" href="/assets/js/90.2d3d5d2d.js"><link rel="prefetch" href="/assets/js/91.a0321263.js"><link rel="prefetch" href="/assets/js/92.5c0eabfe.js"><link rel="prefetch" href="/assets/js/93.23398d7a.js"><link rel="prefetch" href="/assets/js/94.36ade5b0.js"><link rel="prefetch" href="/assets/js/96.7418a5da.js"><link rel="prefetch" href="/assets/js/97.dcc6d772.js"><link rel="prefetch" href="/assets/js/98.94f9e4b6.js"><link rel="prefetch" href="/assets/js/99.8c40a74c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b5f0b03a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Zhaoxu Liu</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/1.html" class="nav-link">
  博文
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="归档" class="dropdown-title"><span class="title">归档</span> <span class="arrow down"></span></button> <button type="button" aria-label="归档" class="mobile-dropdown-title"><span class="title">归档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/go/1.html" class="nav-link">
  go
</a></li><li class="dropdown-item"><!----> <a href="/document/java/1.html" class="nav-link">
  java
</a></li><li class="dropdown-item"><!----> <a href="/document/flutter/init.html" class="nav-link">
  flutter
</a></li><li class="dropdown-item"><!----> <a href="/document/webpack/introduction.html" class="nav-link">
  webpack5
</a></li><li class="dropdown-item"><!----> <a href="/document/tensorflow/1.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  tensorflow
</a></li><li class="dropdown-item"><!----> <a href="/document/mysql/1.html" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/document/nodejs/1.html" class="nav-link">
  nodejs
</a></li><li class="dropdown-item"><!----> <a href="/document/interview/javascript.html" class="nav-link">
  面试
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="读书笔记" class="mobile-dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/book/functional/first.html" class="nav-link">
  JavaScript函数式编程指南
</a></li><li class="dropdown-item"><!----> <a href="/book/professional/1.html" class="nav-link">
  JavaScript高级程序设计
</a></li></ul></div></div><div class="nav-item"><a href="/algorithm/2.html" class="nav-link">
  算法
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/1.html" class="nav-link">
  博文
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="归档" class="dropdown-title"><span class="title">归档</span> <span class="arrow down"></span></button> <button type="button" aria-label="归档" class="mobile-dropdown-title"><span class="title">归档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/go/1.html" class="nav-link">
  go
</a></li><li class="dropdown-item"><!----> <a href="/document/java/1.html" class="nav-link">
  java
</a></li><li class="dropdown-item"><!----> <a href="/document/flutter/init.html" class="nav-link">
  flutter
</a></li><li class="dropdown-item"><!----> <a href="/document/webpack/introduction.html" class="nav-link">
  webpack5
</a></li><li class="dropdown-item"><!----> <a href="/document/tensorflow/1.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  tensorflow
</a></li><li class="dropdown-item"><!----> <a href="/document/mysql/1.html" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/document/nodejs/1.html" class="nav-link">
  nodejs
</a></li><li class="dropdown-item"><!----> <a href="/document/interview/javascript.html" class="nav-link">
  面试
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="读书笔记" class="mobile-dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/book/functional/first.html" class="nav-link">
  JavaScript函数式编程指南
</a></li><li class="dropdown-item"><!----> <a href="/book/professional/1.html" class="nav-link">
  JavaScript高级程序设计
</a></li></ul></div></div><div class="nav-item"><a href="/algorithm/2.html" class="nav-link">
  算法
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>tensorflow</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/document/tensorflow/1.html" aria-current="page" class="active sidebar-link">face-api.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#单击演示" class="sidebar-link">单击演示!</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#讲解" class="sidebar-link">讲解</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#人脸识别" class="sidebar-link">人脸识别</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#人脸坐标检测" class="sidebar-link">人脸坐标检测</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#人脸表情识别" class="sidebar-link">人脸表情识别</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#年龄估计和性别识别" class="sidebar-link">年龄估计和性别识别</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#运行浏览器示例" class="sidebar-link">运行浏览器示例</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#运行node-js示例" class="sidebar-link">运行Node.js示例</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#加载模型" class="sidebar-link">加载模型</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#高级api" class="sidebar-link">高级API</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#显示检测结果" class="sidebar-link">显示检测结果</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#人脸检测选项" class="sidebar-link">人脸检测选项</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#实用程序类" class="sidebar-link">实用程序类</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#其他有用的工具" class="sidebar-link">其他有用的工具</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#人脸检测模型" class="sidebar-link">人脸检测模型</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#_68-点脸地标检测模型" class="sidebar-link">68 点脸地标检测模型</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#人脸识别模型" class="sidebar-link">人脸识别模型</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#人脸表情识别模型" class="sidebar-link">人脸表情识别模型</a></li><li class="sidebar-sub-header"><a href="/document/tensorflow/1.html#年龄和性别识别模型" class="sidebar-link">年龄和性别识别模型</a></li></ul></li><li><a href="/document/tensorflow/2.html" class="sidebar-link">机器学习</a></li><li><a href="/document/tensorflow/3.html" class="sidebar-link">语音识别</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="face-api-js"><a href="#face-api-js" class="header-anchor">#</a> face-api.js</h1> <p><a href="https://travis-ci.org/justadudewhohacks/face-api.js" target="_blank" rel="noopener noreferrer"><img src="https://travis-ci.org/justadudewhohacks/face-api.js.svg?branch=master" alt="Build Status"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://slack.bri.im" target="_blank" rel="noopener noreferrer"><img src="https://slack.bri.im/badge.svg" alt="Slack"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>在tensorflow.js核心之上实现的针对浏览器和Node.js的JavaScript人脸识别API (<a href="https://github.com/tensorflow/tfjs" target="_blank" rel="noopener noreferrer">tensorflow/tfjs-core<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</strong></p> <p><img src="https://user-images.githubusercontent.com/31125521/57224752-ad3dc080-700a-11e9-85b9-1357b9f9bca4.gif" alt="faceapi"></p> <h2 id="单击演示"><a href="#单击演示" class="header-anchor">#</a> <strong><a href="https://justadudewhohacks.github.io/face-api.js/" target="_blank" rel="noopener noreferrer">单击演示!<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></h2> <h2 id="讲解"><a href="#讲解" class="header-anchor">#</a> 讲解</h2> <ul><li><strong><a href="https://itnext.io/face-api-js-javascript-api-for-face-recognition-in-the-browser-with-tensorflow-js-bcc2a6c4cf07" target="_blank" rel="noopener noreferrer">face-api.js — 使用tensorflow.js在浏览器中实现人脸识别的JavaScript API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li> <li><strong><a href="https://itnext.io/realtime-javascript-face-tracking-and-face-recognition-using-face-api-js-mtcnn-face-detector-d924dd8b5740" target="_blank" rel="noopener noreferrer">使用face-api.js的MTCNN人脸检测器进行实时JavaScript人脸跟踪和人脸识别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li> <li><strong><a href="https://youtu.be/CVClHLwv-4I" target="_blank" rel="noopener noreferrer">实时网络摄像头面部检测和情感识别 - 视频<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li> <li><strong><a href="https://youtu.be/AZ4PdALMqx0" target="_blank" rel="noopener noreferrer">JavaScript轻松面部识别教程 - 视频<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li> <li><strong><a href="https://medium.com/@andreas.schallwig/do-not-laugh-a-simple-ai-powered-game-3e22ad0f8166" target="_blank" rel="noopener noreferrer">将face-api.js与Vue.js和Electron结合使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li> <li><strong><a href="https://www.learnwithjason.dev/fun-with-machine-learning-pt-2" target="_blank" rel="noopener noreferrer">为人添加面具-Gant Laborde与Jason一起学习<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong></li></ul> <h1 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h1> <h2 id="人脸识别"><a href="#人脸识别" class="header-anchor">#</a> 人脸识别</h2> <p><img src="https://user-images.githubusercontent.com/31125521/57297377-bfcdfd80-70cf-11e9-8afa-2044cb167bff.gif" alt="face-recognition"></p> <h2 id="人脸坐标检测"><a href="#人脸坐标检测" class="header-anchor">#</a> 人脸坐标检测</h2> <p><img src="https://user-images.githubusercontent.com/31125521/57297731-b1ccac80-70d0-11e9-9bd7-59d77f180322.jpg" alt="face_landmark_detection"></p> <h2 id="人脸表情识别"><a href="#人脸表情识别" class="header-anchor">#</a> 人脸表情识别</h2> <p><img src="https://user-images.githubusercontent.com/31125521/50575270-f501d080-0dfb-11e9-9676-8f419efdade4.png" alt="preview_face-expression-recognition"></p> <h2 id="年龄估计和性别识别"><a href="#年龄估计和性别识别" class="header-anchor">#</a> 年龄估计和性别识别</h2> <p><img src="https://user-images.githubusercontent.com/31125521/57297736-b5603380-70d0-11e9-873d-8b6c7243eb64.jpg" alt="age_gender_recognition"></p> <h1 id="运行示例"><a href="#运行示例" class="header-anchor">#</a> 运行示例</h1> <p>克隆这个仓库:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/justadudewhohacks/face-api.js.git
</code></pre></div><h2 id="运行浏览器示例"><a href="#运行浏览器示例" class="header-anchor">#</a> 运行浏览器示例</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> face-api.js/examples/examples-browser
<span class="token function">npm</span> i
<span class="token function">npm</span> start
</code></pre></div><p>Browse to http://localhost:3000/.</p> <h2 id="运行node-js示例"><a href="#运行node-js示例" class="header-anchor">#</a> 运行Node.js示例</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> face-api.js/examples/examples-nodejs
<span class="token function">npm</span> i
</code></pre></div><p>Now run one of the examples using ts-node:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ts-node faceDetection.ts
</code></pre></div><p>Or simply compile and run them with node:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>tsc faceDetection.ts
node faceDetection.js
</code></pre></div><h1 id="用于浏览器的face-api-js"><a href="#用于浏览器的face-api-js" class="header-anchor">#</a> 用于浏览器的face-api.js</h1> <p>Simply include the latest script from <a href="https://github.com/justadudewhohacks/face-api.js/tree/master/dist" target="_blank" rel="noopener noreferrer">dist/face-api.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>或通过npm安装:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i face-api.js
</code></pre></div><h1 id="用于-node-js-的-face-api-js"><a href="#用于-node-js-的-face-api-js" class="header-anchor">#</a> 用于 Node.js 的 face-api.js</h1> <p>我们可以通过填充一些浏览器细节（例如HTMLImageElement，HTMLCanvasElement和ImageData），在nodejs环境中使用等效的API。最简单的方法是安装node-canvas软件包。</p> <p>另外，您可以简单地从图像数据构造自己的张量，然后将张量作为输入传递到API。</p> <p>此外，您还想安装@ tensorflow / tfjs-node（不是必需的，但强烈建议使用），它可以通过编译并绑定到本机Tensorflow C ++库来大大加快运行速度：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i face-api.js canvas @tensorflow/tfjs-node
</code></pre></div><p>现在，我们简单地猴子修补环境以使用polyfills：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// import nodejs bindings to native tensorflow,</span>
<span class="token comment">// not required, but will speed up things drastically (python required)</span>
<span class="token keyword">import</span> <span class="token string">'@tensorflow/tfjs-node'</span><span class="token punctuation">;</span>

<span class="token comment">// implements nodejs wrappers for HTMLCanvasElement, HTMLImageElement, ImageData</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> canvas <span class="token keyword">from</span> <span class="token string">'canvas'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> faceapi <span class="token keyword">from</span> <span class="token string">'face-api.js'</span><span class="token punctuation">;</span>

<span class="token comment">// patch nodejs environment, we need to provide an implementation of</span>
<span class="token comment">// HTMLCanvasElement and HTMLImageElement</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Canvas<span class="token punctuation">,</span> Image<span class="token punctuation">,</span> ImageData <span class="token punctuation">}</span> <span class="token operator">=</span> canvas
faceapi<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token function">monkeyPatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> Canvas<span class="token punctuation">,</span> Image<span class="token punctuation">,</span> ImageData <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> Getting Started</h1> <h2 id="加载模型"><a href="#加载模型" class="header-anchor">#</a> 加载模型</h2> <p>所有全局神经网络实例都通过faceapi.nets导出：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>faceapi<span class="token punctuation">.</span>nets<span class="token punctuation">)</span>
<span class="token comment">// ageGenderNet</span>
<span class="token comment">// faceExpressionNet</span>
<span class="token comment">// faceLandmark68Net</span>
<span class="token comment">// faceLandmark68TinyNet</span>
<span class="token comment">// faceRecognitionNet</span>
<span class="token comment">// ssdMobilenetv1</span>
<span class="token comment">// tinyFaceDetector</span>
<span class="token comment">// tinyYolov2</span>
</code></pre></div><p>要加载模型，您必须提供相应的manifest.json文件以及模型权重文件（碎片）作为资产。 只需将它们复制到您的公共或资产文件夹中即可。 模型的manifest.json和分片文件必须位于同一目录中，并且可以在同一路径下访问。</p> <p>假设模型位于 <strong>public/models</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> faceapi<span class="token punctuation">.</span>nets<span class="token punctuation">.</span>ssdMobilenetv1<span class="token punctuation">.</span><span class="token function">loadFromUri</span><span class="token punctuation">(</span><span class="token string">'/models'</span><span class="token punctuation">)</span>
<span class="token comment">// accordingly for the other models:</span>
<span class="token comment">// await faceapi.nets.faceLandmark68Net.loadFromUri('/models')</span>
<span class="token comment">// await faceapi.nets.faceRecognitionNet.loadFromUri('/models')</span>
<span class="token comment">// ...</span>
</code></pre></div><p>在nodejs环境中，您还可以直接从磁盘加载模型:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> faceapi<span class="token punctuation">.</span>nets<span class="token punctuation">.</span>ssdMobilenetv1<span class="token punctuation">.</span><span class="token function">loadFromDisk</span><span class="token punctuation">(</span><span class="token string">'./models'</span><span class="token punctuation">)</span>
</code></pre></div><p>您也可以从tf.NamedTensorMap加载模型:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> faceapi<span class="token punctuation">.</span>nets<span class="token punctuation">.</span>ssdMobilenetv1<span class="token punctuation">.</span><span class="token function">loadFromWeightMap</span><span class="token punctuation">(</span>weightMap<span class="token punctuation">)</span>
</code></pre></div><p>或者，您也可以创建自己的神经网络实例:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> net <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>SsdMobilenetv1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> net<span class="token punctuation">.</span><span class="token function">loadFromUri</span><span class="token punctuation">(</span><span class="token string">'/models'</span><span class="token punctuation">)</span>
</code></pre></div><p>您还可以将权重作为Float32Array加载（如果要使用未压缩的模型）:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// using fetch</span>
net<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">fetchNetWeights</span><span class="token punctuation">(</span><span class="token string">'/models/face_detection_model.weights'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// using axios</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/models/face_detection_model.weights'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> responseType<span class="token operator">:</span> <span class="token string">'arraybuffer'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> weights <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
net<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>weights<span class="token punctuation">)</span>
</code></pre></div><h2 id="高级api"><a href="#高级api" class="header-anchor">#</a> 高级API</h2> <p>在下面的输入中，<strong>input</strong> 可以是HTML&lt;img&gt;，视频或画布元素，也可以是该元素的ID.</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myImg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>images/example.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myVideo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>media/example.mp4<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myCanvas<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myImg'</span><span class="token punctuation">)</span>
<span class="token comment">// const input = document.getElementById('myVideo')</span>
<span class="token comment">// const input = document.getElementById('myCanvas')</span>
<span class="token comment">// or simply:</span>
<span class="token comment">// const input = 'myImg'</span>
</code></pre></div><h3 id="侦测人脸"><a href="#侦测人脸" class="header-anchor">#</a> 侦测人脸</h3> <p>Detect all faces in an image. Returns <strong>Array&lt;<a href="#interface-face-detection">FaceDetection</a>&gt;</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detections <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
</code></pre></div><p>检测图像中具有最高置信度得分的脸部。 返回 <strong><a href="#interface-face-detection">FaceDetection</a> | undefined</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detection <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
</code></pre></div><p>默认情况下，<strong>detectAllFaces</strong> 和 <strong>detectSingleFace</strong> 使用SSD Mobilenet V1人脸检测器。 您可以通过传递相应的选项对象来指定面部检测器：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detections1 <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>SsdMobilenetv1Options</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> detections2 <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>TinyFaceDetectorOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>您可以调整每个面部检测器的选项，如图所示 <a href="#getting-started-face-detection-options">here</a>.</p> <h3 id="检测68个人脸地标点"><a href="#检测68个人脸地标点" class="header-anchor">#</a> 检测68个人脸地标点</h3> <p><strong>在面部检测之后，我们可以进一步预测每个检测到的面部的面部标志，如下所示:</strong></p> <p>检测图像中的所有面部+为每个检测到的面部计算68点面部地标. 返回 <strong>Array&lt;<a href="#getting-started-utility-classes">WithFaceLandmarks&lt;WithFaceDetection&lt;{}&gt;&gt;</a>&gt;</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionsWithLandmarks <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>检测图像中具有最高置信度得分的人脸，并为该人脸计算68个点人脸地标. 返回 <strong><a href="#getting-started-utility-classes">WithFaceLandmarks&lt;WithFaceDetection&lt;{}&gt;&gt;</a> | undefined</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionWithLandmarks <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>您还可以指定使用微小模型而不是默认模型:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> useTinyModel <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token keyword">const</span> detectionsWithLandmarks <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span>useTinyModel<span class="token punctuation">)</span>
</code></pre></div><h3 id="计算人脸描述符"><a href="#计算人脸描述符" class="header-anchor">#</a> 计算人脸描述符</h3> <p><strong>在人脸检测和人脸界标预测之后，可以如下计算每个人脸的人脸描述符:</strong></p> <p>检测图像中的所有面部，并为每个检测到的面部计算68点面部地标。返回 <strong>Array&lt;<a href="#getting-started-utility-classes">WithFaceDescriptor&lt;WithFaceLandmarks&lt;WithFaceDetection&lt;{}&gt;&gt;&gt;</a>&gt;</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Detect the face with the highest confidence score in an image + compute 68 Point Face Landmarks and face descriptor for that face. Returns <strong><a href="#getting-started-utility-classes">WithFaceDescriptor&lt;WithFaceLandmarks&lt;WithFaceDetection&lt;{}&gt;&gt;&gt;</a> | undefined</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="识别面部表情"><a href="#识别面部表情" class="header-anchor">#</a> 识别面部表情</h3> <p><strong>可以对检测到的脸部进行脸部表情识别，如下所示:</strong></p> <p>检测图像中的所有面部+识别每个面部的面部表情。 返回 <strong>Array&lt;<a href="#getting-started-utility-classes">WithFaceExpressions&lt;WithFaceLandmarks&lt;WithFaceDetection&lt;{}&gt;&gt;&gt;</a>&gt;</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionsWithExpressions <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>检测图像中具有最高置信度得分的面部，并识别该面部的面部表情。 返回 <strong><a href="#getting-started-utility-classes">WithFaceExpressions&lt;WithFaceLandmarks&lt;WithFaceDetection&lt;{}&gt;&gt;&gt;</a> | undefined</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionWithExpressions <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>您也可以跳过.withFaceLandmarks()，这将跳过人脸对齐步骤（稳定性较差）:</strong></p> <p>检测所有没有面部对齐的面部+识别每个面部的面部表情. 返回 <strong>Array&lt;<a href="#getting-started-utility-classes">WithFaceExpressions&lt;WithFaceDetection&lt;{}&gt;&gt;</a>&gt;</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionsWithExpressions <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>在没有面部对齐的情况下检测具有最高置信度得分的面部+识别该面部的面部表情。 返回 <strong><a href="#getting-started-utility-classes">WithFaceExpressions&lt;WithFaceDetection&lt;{}&gt;&gt;</a> | undefined</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionWithExpressions <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="年龄估计和性别识别-2"><a href="#年龄估计和性别识别-2" class="header-anchor">#</a> 年龄估计和性别识别</h3> <p><strong>从检测到的脸部进行年龄估计和性别识别的方法如下:</strong></p> <p>检测图像中的所有面孔+估计年龄并识别每张面孔的性别。 返回 <strong>Array&lt;<a href="#getting-started-utility-classes">WithAge&lt;WithGender&lt;WithFaceLandmarks&lt;WithFaceDetection&lt;{}&gt;&gt;&gt;&gt;</a>&gt;</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionsWithAgeAndGender <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withAgeAndGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>检测图像中具有最高置信度得分的面部+估计年龄，并识别该面部的性别。 返回 <strong><a href="#getting-started-utility-classes">WithAge&lt;WithGender&lt;WithFaceLandmarks&lt;WithFaceDetection&lt;{}&gt;&gt;&gt;&gt;</a> | undefined</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionWithAgeAndGender <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withAgeAndGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>您也可以跳过.withFaceLandmarks()，这将跳过人脸对齐步骤（稳定性较差）:</strong></p> <p>检测所有没有面部对齐的面孔+估计年龄并识别每张面孔的性别。 返回 <strong>Array&lt;<a href="#getting-started-utility-classes">WithAge&lt;WithGender&lt;WithFaceDetection&lt;{}&gt;&gt;&gt;</a>&gt;</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionsWithAgeAndGender <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withAgeAndGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>在没有面部对齐的情况下检测具有最高置信度得分的面部，并估计年龄并识别该面部的性别。返回 <strong><a href="#getting-started-utility-classes">WithAge&lt;WithGender&lt;WithFaceDetection&lt;{}&gt;&gt;&gt;</a> | undefined</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detectionWithAgeAndGender <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withAgeAndGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="任务组成"><a href="#任务组成" class="header-anchor">#</a> 任务组成</h3> <p><strong>任务可以组成如下:</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// all faces</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withAgeAndGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withAgeAndGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// single face</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withAgeAndGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withAgeAndGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withFaceDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="匹配描述符的人脸识别"><a href="#匹配描述符的人脸识别" class="header-anchor">#</a> 匹配描述符的人脸识别</h3> <p>为了执行面部识别，可以使用faceapi.FaceMatcher比较参考面部描述符和查询面部描述符。</p> <p>首先，我们使用参考数据初始化FaceMatcher，例如，我们可以简单地在<strong>referenceImage</strong>中检测面部并将匹配的面部描述符与后续图像的面部进行匹配</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> faceapi
  <span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>referenceImage<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withFaceDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>results<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token comment">// create FaceMatcher with automatically assigned labels</span>
<span class="token comment">// from the detection results for the reference image</span>
<span class="token keyword">const</span> faceMatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>FaceMatcher</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
</code></pre></div><p>现在我们可以识别出如图所示的人脸 <strong>queryImage1</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> singleResult <span class="token operator">=</span> <span class="token keyword">await</span> faceapi
  <span class="token punctuation">.</span><span class="token function">detectSingleFace</span><span class="token punctuation">(</span>queryImage1<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withFaceDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>singleResult<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> bestMatch <span class="token operator">=</span> faceMatcher<span class="token punctuation">.</span><span class="token function">findBestMatch</span><span class="token punctuation">(</span>singleResult<span class="token punctuation">.</span>descriptor<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bestMatch<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>或者我们可以识别出所有显示在 <strong>queryImage2</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> faceapi
  <span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>queryImage2<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withFaceDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

results<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fd</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> bestMatch <span class="token operator">=</span> faceMatcher<span class="token punctuation">.</span><span class="token function">findBestMatch</span><span class="token punctuation">(</span>fd<span class="token punctuation">.</span>descriptor<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bestMatch<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>您还可以如下创建带标签的引用描述符:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> labeledDescriptors <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>LabeledFaceDescriptors</span><span class="token punctuation">(</span>
    <span class="token string">'obama'</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>descriptorObama1<span class="token punctuation">,</span> descriptorObama2<span class="token punctuation">]</span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>LabeledFaceDescriptors</span><span class="token punctuation">(</span>
    <span class="token string">'trump'</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>descriptorTrump<span class="token punctuation">]</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> faceMatcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>FaceMatcher</span><span class="token punctuation">(</span>labeledDescriptors<span class="token punctuation">)</span>
</code></pre></div><h2 id="显示检测结果"><a href="#显示检测结果" class="header-anchor">#</a> 显示检测结果</h2> <p>准备覆盖画布:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> displaySize <span class="token operator">=</span> <span class="token punctuation">{</span> width<span class="token operator">:</span> input<span class="token punctuation">.</span>width<span class="token punctuation">,</span> height<span class="token operator">:</span> input<span class="token punctuation">.</span>height <span class="token punctuation">}</span>
<span class="token comment">// resize the overlay canvas to the input dimensions</span>
<span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'overlay'</span><span class="token punctuation">)</span>
faceapi<span class="token punctuation">.</span><span class="token function">matchDimensions</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> displaySize<span class="token punctuation">)</span>
</code></pre></div><p>face-api.js预定义了一些高级绘图功能，您可以利用它们:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/* Display detected face bounding boxes */</span>
<span class="token keyword">const</span> detections <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
<span class="token comment">// resize the detected boxes in case your displayed image has a different size than the original</span>
<span class="token keyword">const</span> resizedDetections <span class="token operator">=</span> faceapi<span class="token punctuation">.</span><span class="token function">resizeResults</span><span class="token punctuation">(</span>detections<span class="token punctuation">,</span> displaySize<span class="token punctuation">)</span>
<span class="token comment">// draw detections into the canvas</span>
faceapi<span class="token punctuation">.</span>draw<span class="token punctuation">.</span><span class="token function">drawDetections</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> resizedDetections<span class="token punctuation">)</span>

<span class="token comment">/* Display face landmarks */</span>
<span class="token keyword">const</span> detectionsWithLandmarks <span class="token operator">=</span> <span class="token keyword">await</span> faceapi
  <span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// resize the detected boxes and landmarks in case your displayed image has a different size than the original</span>
<span class="token keyword">const</span> resizedResults <span class="token operator">=</span> faceapi<span class="token punctuation">.</span><span class="token function">resizeResults</span><span class="token punctuation">(</span>detectionsWithLandmarks<span class="token punctuation">,</span> displaySize<span class="token punctuation">)</span>
<span class="token comment">// draw detections into the canvas</span>
faceapi<span class="token punctuation">.</span>draw<span class="token punctuation">.</span><span class="token function">drawDetections</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> resizedResults<span class="token punctuation">)</span>
<span class="token comment">// draw the landmarks into the canvas</span>
faceapi<span class="token punctuation">.</span>draw<span class="token punctuation">.</span><span class="token function">drawFaceLandmarks</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> resizedResults<span class="token punctuation">)</span>


<span class="token comment">/* Display face expression results */</span>
<span class="token keyword">const</span> detectionsWithExpressions <span class="token operator">=</span> <span class="token keyword">await</span> faceapi
  <span class="token punctuation">.</span><span class="token function">detectAllFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withFaceLandmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withFaceExpressions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// resize the detected boxes and landmarks in case your displayed image has a different size than the original</span>
<span class="token keyword">const</span> resizedResults <span class="token operator">=</span> faceapi<span class="token punctuation">.</span><span class="token function">resizeResults</span><span class="token punctuation">(</span>detectionsWithExpressions<span class="token punctuation">,</span> displaySize<span class="token punctuation">)</span>
<span class="token comment">// draw detections into the canvas</span>
faceapi<span class="token punctuation">.</span>draw<span class="token punctuation">.</span><span class="token function">drawDetections</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> resizedResults<span class="token punctuation">)</span>
<span class="token comment">// draw a textbox displaying the face expressions with minimum probability into the canvas</span>
<span class="token keyword">const</span> minProbability <span class="token operator">=</span> <span class="token number">0.05</span>
faceapi<span class="token punctuation">.</span>draw<span class="token punctuation">.</span><span class="token function">drawFaceExpressions</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> resizedResults<span class="token punctuation">,</span> minProbability<span class="token punctuation">)</span>
</code></pre></div><p>您还可以绘制带有自定义文本的框 (<a href="https://github.com/justadudewhohacks/tfjs-image-recognition-base/blob/master/src/draw/DrawBox.ts" target="_blank" rel="noopener noreferrer">DrawBox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>):</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> box <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span>
<span class="token comment">// see DrawBoxOptions below</span>
<span class="token keyword">const</span> drawOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  label<span class="token operator">:</span> <span class="token string">'Hello I am a box!'</span><span class="token punctuation">,</span>
  lineWidth<span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> drawBox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>draw<span class="token punctuation">.</span>DrawBox</span><span class="token punctuation">(</span>box<span class="token punctuation">,</span> drawOptions<span class="token punctuation">)</span>
drawBox<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myCanvas'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>DrawBox绘图选项:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IDrawBoxOptions</span> <span class="token punctuation">{</span>
  boxColor<span class="token operator">?</span><span class="token operator">:</span> string
  lineWidth<span class="token operator">?</span><span class="token operator">:</span> number
  drawLabelOptions<span class="token operator">?</span><span class="token operator">:</span> IDrawTextFieldOptions
  label<span class="token operator">?</span><span class="token operator">:</span> string
<span class="token punctuation">}</span>
</code></pre></div><p>最后，您可以绘制自定义文本字段 (<a href="https://github.com/justadudewhohacks/tfjs-image-recognition-base/blob/master/src/draw/DrawTextField.ts" target="_blank" rel="noopener noreferrer">DrawTextField<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>):</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'This is a textline!'</span><span class="token punctuation">,</span>
  <span class="token string">'This is another textline!'</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> anchor <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span>
<span class="token comment">// see DrawTextField below</span>
<span class="token keyword">const</span> drawOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  anchorPosition<span class="token operator">:</span> <span class="token string">'TOP_LEFT'</span><span class="token punctuation">,</span>
  backgroundColor<span class="token operator">:</span> <span class="token string">'rgba(0, 0, 0, 0.5)'</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> drawBox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>draw<span class="token punctuation">.</span>DrawTextField</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> anchor<span class="token punctuation">,</span> drawOptions<span class="token punctuation">)</span>
drawBox<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myCanvas'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>绘制文本字段的绘制选项:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IDrawTextFieldOptions</span> <span class="token punctuation">{</span>
  anchorPosition<span class="token operator">?</span><span class="token operator">:</span> AnchorPosition
  backgroundColor<span class="token operator">?</span><span class="token operator">:</span> string
  fontColor<span class="token operator">?</span><span class="token operator">:</span> string
  fontSize<span class="token operator">?</span><span class="token operator">:</span> number
  fontStyle<span class="token operator">?</span><span class="token operator">:</span> string
  padding<span class="token operator">?</span><span class="token operator">:</span> number
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">enum</span> AnchorPosition <span class="token punctuation">{</span>
  <span class="token constant">TOP_LEFT</span> <span class="token operator">=</span> <span class="token string">'TOP_LEFT'</span><span class="token punctuation">,</span>
  <span class="token constant">TOP_RIGHT</span> <span class="token operator">=</span> <span class="token string">'TOP_RIGHT'</span><span class="token punctuation">,</span>
  <span class="token constant">BOTTOM_LEFT</span> <span class="token operator">=</span> <span class="token string">'BOTTOM_LEFT'</span><span class="token punctuation">,</span>
  <span class="token constant">BOTTOM_RIGHT</span> <span class="token operator">=</span> <span class="token string">'BOTTOM_RIGHT'</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="人脸检测选项"><a href="#人脸检测选项" class="header-anchor">#</a> 人脸检测选项</h2> <h3 id="ssdmobilenetv1options"><a href="#ssdmobilenetv1options" class="header-anchor">#</a> SsdMobilenetv1Options</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ISsdMobilenetv1Options</span> <span class="token punctuation">{</span>
  <span class="token comment">// minimum confidence threshold</span>
  <span class="token comment">// default: 0.5</span>
  minConfidence<span class="token operator">?</span><span class="token operator">:</span> number

  <span class="token comment">// maximum number of faces to return</span>
  <span class="token comment">// default: 100</span>
  maxResults<span class="token operator">?</span><span class="token operator">:</span> number
<span class="token punctuation">}</span>

<span class="token comment">// example</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>SsdMobilenetv1Options</span><span class="token punctuation">(</span><span class="token punctuation">{</span> minConfidence<span class="token operator">:</span> <span class="token number">0.8</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="微小的面部检测器选项接口"><a href="#微小的面部检测器选项接口" class="header-anchor">#</a> 微小的面部检测器选项接口</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ITinyFaceDetectorOptions</span> <span class="token punctuation">{</span>
  <span class="token comment">// size at which image is processed, the smaller the faster,</span>
  <span class="token comment">// but less precise in detecting smaller faces, must be divisible</span>
  <span class="token comment">// by 32, common sizes are 128, 160, 224, 320, 416, 512, 608,</span>
  <span class="token comment">// for face tracking via webcam I would recommend using smaller sizes,</span>
  <span class="token comment">// e.g. 128, 160, for detecting smaller faces use larger sizes, e.g. 512, 608</span>
  <span class="token comment">// default: 416</span>
  inputSize<span class="token operator">?</span><span class="token operator">:</span> number

  <span class="token comment">// minimum confidence threshold</span>
  <span class="token comment">// default: 0.5</span>
  scoreThreshold<span class="token operator">?</span><span class="token operator">:</span> number
<span class="token punctuation">}</span>

<span class="token comment">// example</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>TinyFaceDetectorOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> inputSize<span class="token operator">:</span> <span class="token number">320</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="实用程序类"><a href="#实用程序类" class="header-anchor">#</a> 实用程序类</h2> <h3 id="box接口"><a href="#box接口" class="header-anchor">#</a> Box接口</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IBox</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> number
  y<span class="token operator">:</span> number
  width<span class="token operator">:</span> number
  height<span class="token operator">:</span> number
<span class="token punctuation">}</span>
</code></pre></div><h3 id="人脸检测接口"><a href="#人脸检测接口" class="header-anchor">#</a> 人脸检测接口</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IFaceDetection</span> <span class="token punctuation">{</span>
  score<span class="token operator">:</span> number
  box<span class="token operator">:</span> Box
<span class="token punctuation">}</span>
</code></pre></div><h3 id="面部坐标接口"><a href="#面部坐标接口" class="header-anchor">#</a> 面部坐标接口</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IFaceLandmarks</span> <span class="token punctuation">{</span>
  positions<span class="token operator">:</span> Point<span class="token punctuation">[</span><span class="token punctuation">]</span>
  shift<span class="token operator">:</span> Point
<span class="token punctuation">}</span>
</code></pre></div><h3 id="带人脸检测"><a href="#带人脸检测" class="header-anchor">#</a> 带人脸检测</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> type WithFaceDetection<span class="token operator">&lt;</span>TSource<span class="token operator">&gt;</span> <span class="token operator">=</span> TSource <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  detection<span class="token operator">:</span> FaceDetection
<span class="token punctuation">}</span>
</code></pre></div><h3 id="带脸部地标"><a href="#带脸部地标" class="header-anchor">#</a> 带脸部地标</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> type WithFaceLandmarks<span class="token operator">&lt;</span>TSource<span class="token operator">&gt;</span> <span class="token operator">=</span> TSource <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  unshiftedLandmarks<span class="token operator">:</span> FaceLandmarks
  landmarks<span class="token operator">:</span> FaceLandmarks
  alignedRect<span class="token operator">:</span> FaceDetection
<span class="token punctuation">}</span>
</code></pre></div><h3 id="带面部描述符"><a href="#带面部描述符" class="header-anchor">#</a> 带面部描述符</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> type WithFaceDescriptor<span class="token operator">&lt;</span>TSource<span class="token operator">&gt;</span> <span class="token operator">=</span> TSource <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  descriptor<span class="token operator">:</span> Float32Array
<span class="token punctuation">}</span>
</code></pre></div><h3 id="带有面部表情"><a href="#带有面部表情" class="header-anchor">#</a> 带有面部表情</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> type WithFaceExpressions<span class="token operator">&lt;</span>TSource<span class="token operator">&gt;</span> <span class="token operator">=</span> TSource <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  expressions<span class="token operator">:</span> FaceExpressions
<span class="token punctuation">}</span>
</code></pre></div><h3 id="带有年龄"><a href="#带有年龄" class="header-anchor">#</a> 带有年龄</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> type WithAge<span class="token operator">&lt;</span>TSource<span class="token operator">&gt;</span> <span class="token operator">=</span> TSource <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  age<span class="token operator">:</span> number
<span class="token punctuation">}</span>
</code></pre></div><h3 id="带有性别"><a href="#带有性别" class="header-anchor">#</a> 带有性别</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> type WithGender<span class="token operator">&lt;</span>TSource<span class="token operator">&gt;</span> <span class="token operator">=</span> TSource <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
  gender<span class="token operator">:</span> Gender
  genderProbability<span class="token operator">:</span> number
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">enum</span> Gender <span class="token punctuation">{</span>
  <span class="token constant">FEMALE</span> <span class="token operator">=</span> <span class="token string">'female'</span><span class="token punctuation">,</span>
  <span class="token constant">MALE</span> <span class="token operator">=</span> <span class="token string">'male'</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="其他有用的工具"><a href="#其他有用的工具" class="header-anchor">#</a> 其他有用的工具</h2> <h3 id="使用底层api"><a href="#使用底层api" class="header-anchor">#</a> 使用底层API</h3> <p>您可以直接使用每个神经网络的转发方法，而不必使用高级API：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> detections1 <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">ssdMobilenetv1</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token keyword">const</span> detections2 <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">tinyFaceDetector</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token keyword">const</span> landmarks1 <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectFaceLandmarks</span><span class="token punctuation">(</span>faceImage<span class="token punctuation">)</span>
<span class="token keyword">const</span> landmarks2 <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">detectFaceLandmarksTiny</span><span class="token punctuation">(</span>faceImage<span class="token punctuation">)</span>
<span class="token keyword">const</span> descriptor <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">computeFaceDescriptor</span><span class="token punctuation">(</span>alignedFaceImage<span class="token punctuation">)</span>
</code></pre></div><h3 id="提取图像区域的画布"><a href="#提取图像区域的画布" class="header-anchor">#</a> 提取图像区域的画布</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> regionsToExtract <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">faceapi<span class="token punctuation">.</span>Rect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
<span class="token comment">// actually extractFaces is meant to extract face regions from bounding boxes</span>
<span class="token comment">// but you can also use it to extract any other region</span>
<span class="token keyword">const</span> canvases <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">extractFaces</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> regionsToExtract<span class="token punctuation">)</span>
</code></pre></div><h3 id="欧式距离"><a href="#欧式距离" class="header-anchor">#</a> 欧式距离</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ment to be used for computing the euclidean distance between two face descriptors</span>
<span class="token keyword">const</span> dist <span class="token operator">=</span> faceapi<span class="token punctuation">.</span><span class="token function">euclideanDistance</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dist<span class="token punctuation">)</span> <span class="token comment">// 10</span>
</code></pre></div><h3 id="检索人脸坐标点和轮廓"><a href="#检索人脸坐标点和轮廓" class="header-anchor">#</a> 检索人脸坐标点和轮廓</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> landmarkPositions <span class="token operator">=</span> landmarks<span class="token punctuation">.</span>positions

<span class="token comment">// or get the positions of individual contours,</span>
<span class="token comment">// only available for 68 point face ladnamrks (FaceLandmarks68)</span>
<span class="token keyword">const</span> jawOutline <span class="token operator">=</span> landmarks<span class="token punctuation">.</span><span class="token function">getJawOutline</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> nose <span class="token operator">=</span> landmarks<span class="token punctuation">.</span><span class="token function">getNose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> mouth <span class="token operator">=</span> landmarks<span class="token punctuation">.</span><span class="token function">getMouth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> leftEye <span class="token operator">=</span> landmarks<span class="token punctuation">.</span><span class="token function">getLeftEye</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> rightEye <span class="token operator">=</span> landmarks<span class="token punctuation">.</span><span class="token function">getRightEye</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> leftEyeBbrow <span class="token operator">=</span> landmarks<span class="token punctuation">.</span><span class="token function">getLeftEyeBrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> rightEyeBrow <span class="token operator">=</span> landmarks<span class="token punctuation">.</span><span class="token function">getRightEyeBrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="从url获取和显示图像"><a href="#从url获取和显示图像" class="header-anchor">#</a> 从URL获取和显示图像</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myImg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">fetchImage</span><span class="token punctuation">(</span><span class="token string">'/images/example.png'</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>image <span class="token keyword">instanceof</span> <span class="token class-name">HTMLImageElement</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token comment">// displaying the fetched image content</span>
<span class="token keyword">const</span> myImg <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myImg'</span><span class="token punctuation">)</span>
myImg<span class="token punctuation">.</span>src <span class="token operator">=</span> image<span class="token punctuation">.</span>src
</code></pre></div><h3 id="请求json数据"><a href="#请求json数据" class="header-anchor">#</a> 请求JSON数据</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">fetchJson</span><span class="token punctuation">(</span><span class="token string">'/files/example.json'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="创建一个图像选择器"><a href="#创建一个图像选择器" class="header-anchor">#</a> 创建一个图像选择器</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myImg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myFileUpload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>uploadImage()<span class="token punctuation">&quot;</span></span> <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.jpg, .jpeg, .png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">uploadImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> imgFile <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myFileUpload'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token comment">// create an HTMLImageElement from a Blob</span>
  <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">await</span> faceapi<span class="token punctuation">.</span><span class="token function">bufferToImage</span><span class="token punctuation">(</span>imgFile<span class="token punctuation">)</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myImg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src <span class="token operator">=</span> img<span class="token punctuation">.</span>src
<span class="token punctuation">}</span>
</code></pre></div><h3 id="从图像或视频元素创建画布元素"><a href="#从图像或视频元素创建画布元素" class="header-anchor">#</a> 从图像或视频元素创建画布元素</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myImg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>images/example.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myVideo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>media/example.mp4<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> canvas1 <span class="token operator">=</span> faceapi<span class="token punctuation">.</span><span class="token function">createCanvasFromMedia</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myImg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> canvas2 <span class="token operator">=</span> faceapi<span class="token punctuation">.</span><span class="token function">createCanvasFromMedia</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myVideo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="可用型号"><a href="#可用型号" class="header-anchor">#</a> 可用型号</h1> <h2 id="人脸检测模型"><a href="#人脸检测模型" class="header-anchor">#</a> 人脸检测模型</h2> <h3 id="ssd-mobilenet-v1"><a href="#ssd-mobilenet-v1" class="header-anchor">#</a> SSD Mobilenet V1</h3> <p>对于人脸检测，该项目实现了基于MobileNetV1的SSD（单发多盒检测器）。 神经网络将计算图像中每个面部的位置，并将返回边界框以及每个面部的概率。 该面部检测器旨在在检测面部边界框方面获得高精度，而不是低的推理时间。 量化模型的大小约为5.4 MB (<strong>ssd_mobilenetv1_model</strong>).</p> <p>人脸检测模型已经通过以下进行训练 <a href="http://mmlab.ie.cuhk.edu.hk/projects/WIDERFace/" target="_blank" rel="noopener noreferrer">WIDERFACE dataset<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> , 权重由 <a href="https://github.com/yeephycho" target="_blank" rel="noopener noreferrer">yeephycho<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 在 <a href="https://github.com/yeephycho/tensorflow-face-detection" target="_blank" rel="noopener noreferrer">this<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 仓库.</p> <h3 id="微小的面部检测器"><a href="#微小的面部检测器" class="header-anchor">#</a> 微小的面部检测器</h3> <p>Tiny Face Detector是一种高性能的实时面部检测器，与SSD Mobilenet V1面部检测器相比，它更快，更小且资源消耗更少，因此，它在检测小面部方面的性能稍差。 该模型具有极佳的移动性和Web友好性，因此它应该是您在移动设备和资源受限的客户端上的GO-TO人脸检测器。 量化模型的大小仅为190 KB（<strong>tiny_face_detector_model</strong>）。</p> <p>面部检测器已在约14K图像的自定义数据集上训练，该数据集带有边框。 此外，该模型已经过训练，可以预测完全覆盖面部特征点的边界框，因此与SSD Mobilenet V1相比，与随后的面部界标检测结合使用时，通常产生更好的结果。</p> <p>该模型基本上是Tiny Yolo V2的甚至更细小的版本，用深度可分离的卷积代替了Yolo的常规卷积。 Yolo是完全卷积的，因此可以轻松地适应不同的输入图像大小，以牺牲性能（推理时间）的准确性。</p> <h2 id="_68-点脸地标检测模型"><a href="#_68-点脸地标检测模型" class="header-anchor">#</a> 68 点脸地标检测模型</h2> <p>该软件包实现了非常轻巧，快速但准确的68点面部界标检测器。 默认模型的大小仅为350kb（<strong>face_landmark_68_model</strong>），微型模型的大小仅为80kb（<strong>face_landmark_68_tiny_model</strong>）。 两种模型都采用了深度可分离卷积以及密集连接的块的思想。 该模型已在约有35,000张面部图像的数据集上进行了训练，这些数据用68个面部界标点标记。</p> <h2 id="人脸识别模型"><a href="#人脸识别模型" class="header-anchor">#</a> 人脸识别模型</h2> <p>对于人脸识别，实施类似于ResNet-34的体系结构以从任何给定的人脸图像计算人脸描述符（具有128个值的特征向量），该描述符用于描述人脸的特征。 该模型“不限于”用于训练的脸部集合，这意味着您可以将其用于任何人（例如您自己）的脸部识别。 您可以通过比较两个任意脸部的脸部描述符来确定它们的相似性，例如，通过计算欧几里德距离或使用您选择的任何其他分类器。</p> <p>神经网络等效于 <a href="https://github.com/justadudewhohacks/face-recognition.js" target="_blank" rel="noopener noreferrer">face-recognition.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中使用的 <strong>FaceRecognizerNet</strong> 和 <a href="https://github.com/davisking/dlib/blob/master/examples/dnn_face_recognition_ex.cpp" target="_blank" rel="noopener noreferrer">dlib<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 人脸识别示例。 权重已经通过 <a href="https://github.com/davisking" target="_blank" rel="noopener noreferrer">davisking<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 进行了训练，该模型在LFW（野外标签脸）基准进行人脸识别时达到了99.38％的预测准确性。</p> <p>量化模型的大小约为6.2 MB (<strong>face_recognition_model</strong>).</p> <h2 id="人脸表情识别模型"><a href="#人脸表情识别模型" class="header-anchor">#</a> 人脸表情识别模型</h2> <p>面部表情识别模型轻巧，快速，并提供合理的准确性。 该模型的大小约为310kb，采用深度可分离卷积和密集连接的块。 已经对来自公开可用数据集的各种图像以及从网络上抓取的图像进行了培训。 请注意，戴眼镜可能会降低预测结果的准确性。</p> <h2 id="年龄和性别识别模型"><a href="#年龄和性别识别模型" class="header-anchor">#</a> 年龄和性别识别模型</h2> <p>年龄和性别识别模型是一个多任务网络，它使用特征提取层，年龄回归层和性别分类器。 该模型的大小约为420kb，特征提取器采用了与Xception比较细微但非常相似的体系结构。</p> <p>此模型已在以下数据库中经过训练和测试，每个数据库分别进行80/20的训练/测试划分：UTK，FGNET，Chalearn，Wiki，IMDB *，CACD *，MegaAge，MegaAge-Asian。 *表示这些数据库已通过算法清理，因为初始数据库非常嘈杂。</p> <h3 id="总测试结果"><a href="#总测试结果" class="header-anchor">#</a> 总测试结果</h3> <p>总MAE（平均年龄误差）: <strong>4.54</strong></p> <p>总性别准确度: <strong>95%</strong></p> <h3 id="每个数据库的测试结果"><a href="#每个数据库的测试结果" class="header-anchor">#</a> 每个数据库的测试结果</h3> <p>“-”表示没有可用于这些数据库的性别标签。</p> <table><thead><tr><th>Database</th> <th style="text-align:right;">UTK</th> <th style="text-align:right;">FGNET</th> <th style="text-align:right;">Chalearn</th> <th style="text-align:right;">Wiki</th> <th style="text-align:right;">IMDB*</th> <th style="text-align:right;">CACD*</th> <th style="text-align:right;">MegaAge</th> <th style="text-align:right;">MegaAge-Asian</th></tr></thead> <tbody><tr><td>MAE</td> <td style="text-align:right;">5.25</td> <td style="text-align:right;">4.23</td> <td style="text-align:right;">6.24</td> <td style="text-align:right;">6.54</td> <td style="text-align:right;">3.63</td> <td style="text-align:right;">3.20</td> <td style="text-align:right;">6.23</td> <td style="text-align:right;">4.21</td></tr> <tr><td>Gender Accuracy</td> <td style="text-align:right;">0.93</td> <td style="text-align:right;">-</td> <td style="text-align:right;">0.94</td> <td style="text-align:right;">0.95</td> <td style="text-align:right;">-</td> <td style="text-align:right;">0.97</td> <td style="text-align:right;">-</td> <td style="text-align:right;">-</td></tr></tbody></table> <h3 id="不同年龄组的测试结果"><a href="#不同年龄组的测试结果" class="header-anchor">#</a> 不同年龄组的测试结果</h3> <table><thead><tr><th>Age Range</th> <th style="text-align:right;">0 - 3</th> <th style="text-align:right;">4 - 8</th> <th style="text-align:right;">9 - 18</th> <th style="text-align:right;">19 - 28</th> <th style="text-align:right;">29 - 40</th> <th style="text-align:right;">41 - 60</th> <th style="text-align:right;">60 - 80</th> <th style="text-align:right;">80+</th></tr></thead> <tbody><tr><td>MAE</td> <td style="text-align:right;">1.52</td> <td style="text-align:right;">3.06</td> <td style="text-align:right;">4.82</td> <td style="text-align:right;">4.99</td> <td style="text-align:right;">5.43</td> <td style="text-align:right;">4.94</td> <td style="text-align:right;">6.17</td> <td style="text-align:right;">9.91</td></tr> <tr><td>Gender Accuracy</td> <td style="text-align:right;">0.69</td> <td style="text-align:right;">0.80</td> <td style="text-align:right;">0.88</td> <td style="text-align:right;">0.96</td> <td style="text-align:right;">0.97</td> <td style="text-align:right;">0.97</td> <td style="text-align:right;">0.96</td> <td style="text-align:right;">0.9</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/document/tensorflow/2.html">
        机器学习
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.07bc8ac9.js" defer></script><script src="/assets/js/2.54df97aa.js" defer></script><script src="/assets/js/95.bba70dd1.js" defer></script>
  </body>
</html>
